\input{./praeambel.tex}
\begin{document}

\begin{titlepage}
\begin{center}
\vspace*{1cm}
\includegraphics[width=2cm]{./Figures/zk_48_logo.png}
\vspace*{1cm}

\Huge {Technical Documentation\\} 
\vspace*{1cm}
\Huge{\textbf{48 Output Wired and Programmable\\ Pyrotechnic Ignition System\\ based on the ATTINY 861\\}}
\vspace*{0.5cm} 
\Large{by Markus K. \textit{alias inimodo}}
\vspace*{0.5cm}

\Large{2023}
\end{center}
\end{titlepage}

\pagebreak 

\tableofcontents

\pagebreak

\section{Introduction}
The ZK-48 (German "Zündkasten 48 Ausgänge") ignition system was designed as there are little to none cheap alternatives to popular programmable systems which cost many thousand euros. The goal was a  affordable yet reliable system that costs less than 200 euros. This document provides all information surrounding this project and anyone with knowledge in basic electronics should be able to replicate it. Although this is not an instruction on how to build this device,still the author hopes it is useful to a pyrotechnic and or electronics enthusiast. The finished device is shown in \Cref{fig:complete_with_trig_and_mod} with the trigger on the right and one module on the left.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=15cm]{./Figures/complete_with_trig_and_mod.JPG}
    \caption{The resulting complete system with igniter and some modules.}
    \label{fig:complete_with_trig_and_mod}     
\end{figure}

\pagebreak

\section{Hardware}
\label{Hardware}

\subsection{Concept}
\label{Concept}
The device is split into three components: controller, trigger and modules (See \Cref{fig:concept}). The controller is the center piece, that houses the micro controller which is a ATTINY 861\footnote{\url{https://www.mouser.com/datasheet/2/268/Atmel_2588_8_bit_AVR_Microcontrollers_tinyAVR_ATti-1315472.pdf}} from Atmel. On board the controller are the on/off switch, the arm switch,a USB port, status LEDs and connectors for the trigger and modules. The trigger is connected by a $15m$ long cable which also contains a arm switch and the trigger button. There are six modules and each module is able to ignite eight bridge wire detonators (A-Type Only). The modules are also connected by cable to the controller. Two different cable lengths were used for the modules: 3x $4m$ and 3x $8m$. Therefore the complete system is capable of setting of 48 detonators.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=10cm]{./Figures/concept.png}
    \caption{Basic layout of the three components controller, trigger and modules.}
    \label{fig:concept}     
\end{figure}

\noindent The system operates only operates in the fire-and-forget modes in which the user arms the controller and the trigger and after pressing the trigger button the controller will automatically ignite the firework in the programmed sequence. No user input is needed after setting off. When the trigger is pressed the system goes into a $10s$ delay phase in order for the user to get to safety. After the delay phase is finished, the ignition phase is entered, where the programmed sequence will play through until the predetermined endpoint is reached. The trigger can be replaced with a RF-trigger although this is not recommend due safety and legal concerns in some countries. The delay period also serves as a fail safe, because if the system is triggered by accident, the user is able to abort the start by disarming the system. During the ignition phase it is also possible to halt the program by disarming the system, although re-triggering will go through the delay phase once again.\\



\noindent The ignition program is programmed by USB via serial communication(See \cref{USB Connection}). Programming the sequence can be accomplished by directly connecting to the serial port and typing the commands by hand or by using the Software provided(See \cref{Software}).\\

\noindent As the device is placed in open-air there is no way for it to be connect to mains power, therefore it has to be powered by batteries. However, the usage of rechargeable batteries or LiPo-batteries was not desirable for this project, due cost issues and the additional requirement of undercharging protection. A better alternative was found by using common $5V$ powerbanks for smart phones. Those already provide steady $5V$ with build-in protective mechanisms. Furthermore, nowdays many people use powerbanks and the user forgets to charge or forgets the powerbank altogether, there is a high chance some will be able to provide one as replacement. Also a powerbank can be charged by a simple micro USB cable which is also very common.





\pagebreak

\subsection{Components}
As already explained in \cref{Concept}, the device is split into three parts. In this section we will explore each part separately by looking into the design choices that were made. Although the controller is described as one unit, it really consist  of to distinct circuits. One is the ignition voltage generator (See \cref{Ignition Voltage Generator}) which is responsible for generating the voltage/charge that is necessary for setting off the bridge wire detonators. The other circuit is the actual controller that does the controlling (See \cref{Controller}).


\subsubsection{Ignition Voltage Generator}
\label{Ignition Voltage Generator}



\noindent The step-up convert shown in \Cref{fig:ivg_circuit} works by the basic principle of a step-up/boost converter by storing energy in form of a magnetic field inside a inductor and releasing the energy as a current into a capacitor. Repeat this process at high frequency and a higher voltage is created at the output compared to the input voltage. For a better explanation see the document about this topic by \textit{Texas-Instruments}\footnote{\url{https://www.ti.com/lit/an/snva731/snva731.pdf}}.


\paragraph{Circuit}

\begin{figure}[!ht]
    \centering
    \includegraphics[width=15cm]{./Figures/ivg_circuit.png}
    \caption{Circuit of the step-up converter that generates 15V DC for the ignition voltage}
    \label{fig:ivg_circuit}     
\end{figure}

\noindent \small{\textit{Note from the Author: Please note that the ignition voltage generator was designed by my self and is by no means ideal nor in any way optimized. This was my first attempt at creating a step-up convert from scratch and i used the components i had on hand. It does the job but any bought step-up convert will do just fine.}}\\


\subsubsection{Controller}
\label{Controller}
\paragraph{Circuit}
\paragraph{Housing}

\subsubsection{Trigger}
\paragraph{Circuit}
\paragraph{Housing}

\subsubsection{Modules}
\paragraph{Circuit}
\paragraph{Housing}


\section{Firmware}
\label{Firmware}

\subsubsection{USB Connection}
\label{USB Connection}
\paragraph{Program Mode}
\paragraph{Commands}


\section{Software}
\label{Software}

\footnote{Cringe}



\end{document}
